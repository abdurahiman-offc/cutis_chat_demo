<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Automex | WhatsApp Lead System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap');

        body {
            font-family: 'Plus+Jakarta+Sans', sans-serif;
            background: radial-gradient(circle at top right, #0f172a, #020617);
        }

        .whatsapp-bg { background-color: #e5ddd5; background-image: url('https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png'); }
        .message-in { background-color: #ffffff; border-radius: 0 8px 8px 8px; box-shadow: 0 1px 0.5px rgba(0,0,0,0.13); position: relative; }
        .message-out { background-color: #dcf8c6; border-radius: 8px 0 8px 8px; box-shadow: 0 1px 0.5px rgba(0,0,0,0.13); }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        
        .wa-list-box { border-radius: 12px; overflow: hidden; border: 1px solid #e2e8f0; background: white; width: 100%; margin-top: 5px; }
        .wa-list-header { background: #ffffff; color: #00a884; padding: 12px; font-weight: 700; border-bottom: 1px solid #f0f0f0; font-size: 13px; }
        .wa-list-item { padding: 12px; border-bottom: 1px solid #f8f8f8; cursor: pointer; font-size: 14px; color: #111b21; transition: background 0.2s; }
        .wa-list-item:hover { background: #f0f2f5; }
        
        .typing-dot { animation: blink 1.4s infinite both; }
        @keyframes blink { 0% { opacity: 0.2; } 20% { opacity: 1; } 100% { opacity: 0.2; } }

        .fade-in { animation: fadeIn 0.3s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        
        .hide-anim { transition: all 0.3s ease; opacity: 0; transform: scale(0.9); pointer-events: none; }

        .tab-active { background-color: rgba(16, 185, 129, 0.1); color: #10b981; border: 1px solid rgba(16, 185, 129, 0.2); }
        
        .glass-card { 
            background: rgba(15, 23, 42, 0.6); 
            backdrop-filter: blur(12px); 
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 4px 20px -2px rgba(0, 0, 0, 0.5);
        }
        .glass-card:hover {
            border-color: rgba(16, 185, 129, 0.4);
            transform: translateY(-2px);
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center text-slate-100">

    <!-- Top Navigation -->
    <div class="w-full max-w-5xl flex justify-between items-center p-6 mb-4">
        <div class="flex items-center gap-3">
            <div class="w-10 h-10 bg-emerald-500 rounded-xl flex items-center justify-center shadow-lg shadow-emerald-500/30">
                <i class="fas fa-robot text-white text-xl"></i>
            </div>
            <h1 class="text-xl font-extrabold tracking-tight uppercase italic">Automex <span class="text-emerald-500">Pro</span></h1>
        </div>
        
        <div class="flex bg-slate-900/80 p-1 rounded-2xl border border-slate-800 backdrop-blur-md">
            <button onclick="switchTab('chat')" id="tab-chat" class="px-6 py-2.5 rounded-xl text-sm font-bold transition-all tab-active">
                <i class="fab fa-whatsapp mr-2"></i>Simulator
            </button>
            <button onclick="switchTab('dashboard')" id="tab-dashboard" class="px-6 py-2.5 rounded-xl text-sm font-bold transition-all text-slate-400 hover:text-white">
                <i class="fas fa-chart-line mr-2"></i>Dashboard
            </button>
        </div>
    </div>

    <!-- Main Content Area -->
    <main class="w-full flex flex-col items-center px-4">
        
        <!-- Tab 1: WhatsApp Simulator -->
        <div id="view-chat" class="w-full flex flex-col items-center">
            <div class="w-full max-w-md bg-white h-[78vh] shadow-2xl rounded-[3rem] overflow-hidden flex flex-col border-[12px] border-slate-900 relative shadow-emerald-950/20">
                <!-- Header -->
                <div class="bg-[#075e54] text-white p-4 pt-8 flex items-center gap-3 shrink-0 z-20">
                    <i class="fas fa-arrow-left"></i>
                    <div class="w-10 h-10 bg-white/20 rounded-full flex items-center justify-center text-lg font-bold">H</div>
                    <div class="flex-1">
                        <h2 class="font-bold text-[15px] leading-tight">Career Guide</h2>
                        <p class="text-[11px] opacity-80">Online Scholarship Desk</p>
                    </div>
                    <div class="flex gap-4 text-sm">
                        <i class="fas fa-video"></i>
                        <i class="fas fa-phone"></i>
                        <i class="fas fa-ellipsis-v"></i>
                    </div>
                </div>

                <!-- Chat Area -->
                <div id="chat-container" class="whatsapp-bg flex-1 p-4 overflow-y-auto flex flex-col gap-3 hide-scrollbar relative">
                    <div id="anchor"></div>
                </div>

                <!-- Input Area -->
                <div class="bg-[#f0f0f0] p-4 flex items-center gap-3 shrink-0 z-20">
                    <div class="flex-1 bg-white rounded-full px-4 py-2.5 flex items-center gap-2 shadow-sm border border-gray-200">
                        <input id="user-input" type="text" placeholder="Type a message" class="flex-1 outline-none text-[15px] bg-transparent text-slate-900" disabled>
                    </div>
                    <button id="send-btn" onclick="handleUserInput()" class="bg-[#075e54] text-white w-12 h-12 rounded-full flex items-center justify-center shadow-md opacity-50 transition-transform active:scale-90" disabled>
                        <i class="fas fa-paper-plane text-sm"></i>
                    </button>
                </div>
            </div>

            <button onclick="initChat()" class="mt-8 bg-slate-900/80 backdrop-blur-sm text-emerald-400 px-8 py-3.5 rounded-2xl shadow-xl font-bold uppercase tracking-widest hover:bg-slate-800 active:scale-95 transition-all flex items-center gap-3 border border-slate-700">
                <i class="fas fa-sync-alt"></i> Restart Demo
            </button>
        </div>

        <!-- Tab 2: Dashboard -->
        <div id="view-dashboard" class="hidden w-full max-w-6xl pb-20 fade-in">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-10 bg-slate-900/40 p-6 rounded-3xl border border-slate-800">
                <div>
                    <h2 class="text-3xl font-extrabold tracking-tight">QUALIFIED <span class="text-emerald-500">LEADS</span></h2>
                    <p class="text-slate-400 text-sm mt-1">Reviewing candidates for scholarship eligibility</p>
                </div>
                <button onclick="clearLeads()" class="bg-red-500/10 text-red-400 hover:bg-red-500 hover:text-white px-5 py-2.5 rounded-xl text-xs font-bold transition-all flex items-center gap-2 border border-red-500/20 group">
                    <i class="fas fa-trash-alt group-hover:animate-pulse"></i> Clear Database
                </button>
            </div>

            <div id="leads-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Cards injected here -->
            </div>

            <!-- Empty State -->
            <div id="empty-state" class="hidden flex flex-col items-center justify-center py-32 bg-slate-900/20 rounded-[3rem] border-2 border-dashed border-slate-800/50">
                <div class="w-20 h-20 bg-slate-800/50 rounded-full flex items-center justify-center mb-6">
                    <i class="fas fa-user-secret text-4xl text-slate-600"></i>
                </div>
                <h3 class="text-xl font-bold text-slate-400">Database is empty</h3>
                <p class="text-slate-500 text-sm mt-2">Active leads will appear here after chat completion.</p>
                <button onclick="switchTab('chat')" class="mt-6 text-emerald-500 font-bold hover:underline">Go to Simulator â†’</button>
            </div>
        </div>

    </main>

    <script>
        // State Management
        const chat = document.getElementById('chat-container');
        const input = document.getElementById('user-input');
        const btn = document.getElementById('send-btn');
        const leadsGrid = document.getElementById('leads-grid');
        const emptyState = document.getElementById('empty-state');
        
        let currentStep = "";
        let userData = {
            name: "",
            course: "",
            location: "",
            college: ""
        };

        const collegeData = {
            'Manglore': ['Sreenivasa', 'Yenepoa', 'AJ', 'MV Shetty', 'Kanachur', 'Manglore College of Allied'],
            'Banglore': ['Christ', 'Jain', 'Ajaria', 'Reva'],
            'Tamil Nadu': ['JSS', 'SRM']
        };

        // Tab Switching
        function switchTab(tab) {
            const chatView = document.getElementById('view-chat');
            const dashView = document.getElementById('view-dashboard');
            const chatBtn = document.getElementById('tab-chat');
            const dashBtn = document.getElementById('tab-dashboard');

            if (tab === 'chat') {
                chatView.classList.remove('hidden');
                dashView.classList.add('hidden');
                chatBtn.classList.add('tab-active');
                chatBtn.classList.remove('text-slate-400');
                dashBtn.classList.remove('tab-active');
                dashBtn.classList.add('text-slate-400');
            } else {
                chatView.classList.add('hidden');
                dashView.classList.remove('hidden');
                dashBtn.classList.add('tab-active');
                dashBtn.classList.remove('text-slate-400');
                chatBtn.classList.remove('tab-active');
                chatBtn.classList.add('text-slate-400');
                renderLeads();
            }
        }

        // --- WHATSAPP CORE ---

        function initChat() {
            chat.innerHTML = '<div id="anchor"></div>';
            currentStep = "";
            userData = { name: "", course: "", location: "", college: "" };
            input.value = "";
            input.disabled = true;
            btn.disabled = true;
            btn.classList.add('opacity-50');

            addMsg('Hello ðŸ‘‹<br><br>Welcome to the <b>Pro Career</b> scholarship portal. Are you looking to join a professional course this year?', 'in');
            
            renderButtons(['YES', 'NO'], (val) => {
                if(val === 'YES') handleStart();
                else handleExit();
            });
        }

        function forceScroll() {
            setTimeout(() => { chat.scrollTo({ top: chat.scrollHeight, behavior: 'smooth' }); }, 50);
        }

        function addMsg(text, side) {
            const msg = document.createElement('div');
            msg.className = `${side === 'out' ? 'message-out self-end' : 'message-in self-start'} p-3.5 max-w-[85%] mb-1.5 fade-in text-slate-900 leading-relaxed`;
            msg.innerHTML = `<p class="text-[14px]">${text}</p>`;
            chat.insertBefore(msg, document.getElementById('anchor'));
            forceScroll();
        }

        function showTyping(callback) {
            const t = document.createElement('div');
            t.className = 'text-[11px] text-gray-500 font-medium ml-2 mb-2 fade-in';
            t.innerHTML = 'typing<span class="typing-dot">.</span><span class="typing-dot">.</span><span class="typing-dot">.</span>';
            chat.insertBefore(t, document.getElementById('anchor'));
            forceScroll();
            setTimeout(() => { t.remove(); callback(); }, 800);
        }

        function handleStart() {
            showTyping(() => {
                addMsg('Great! Let\'s start with your <b>Full Name</b>?', 'in');
                input.disabled = false; btn.disabled = false; btn.classList.remove('opacity-50');
                input.focus();
                currentStep = "ASK_NAME";
            });
        }

        function handleExit() {
            addMsg('No problem! Feel free to message us anytime you change your mind. Have a nice day!', 'in');
        }

        function handleUserInput() {
            const val = input.value.trim();
            if(!val) return;
            addMsg(val, 'out');
            input.value = '';
            input.disabled = true; btn.disabled = true; btn.classList.add('opacity-50');

            if(currentStep === "ASK_NAME") {
                userData.name = val;
                showTyping(() => {
                    addMsg(`Nice to meet you, ${val}! Which stream are you interested in?`, 'in');
                    renderButtons(['BCA', 'Paramedical', 'Nursing'], (course) => {
                        userData.course = course;
                        showTyping(() => {
                            addMsg('Please select your preferred location:', 'in');
                            renderButtons(['Manglore', 'Banglore', 'Tamil Nadu', 'Other'], handleLocationChoice);
                        });
                    });
                });
            } else if(currentStep === "ASK_OTHER_UNI") {
                userData.college = val;
                userData.location = "Custom";
                saveLead();
                showTyping(() => {
                    addMsg(`Success! A career guide will contact you regarding <b>${val}</b> soon.`, 'in');
                });
            }
        }

        function renderButtons(opts, callback) {
            const div = document.createElement('div');
            div.className = 'flex flex-col gap-2 max-w-[85%] mt-1 fade-in';
            opts.forEach(o => {
                const b = document.createElement('button');
                b.className = 'bg-white text-[#075e54] py-3.5 rounded-xl shadow-sm border border-emerald-100 text-left px-5 hover:bg-emerald-50 active:scale-[0.98] transition-all font-bold text-[14px]';
                b.innerText = o;
                b.onclick = () => {
                    div.classList.add('hide-anim');
                    setTimeout(() => div.remove(), 300);
                    addMsg(o, 'out');
                    callback(o);
                };
                div.appendChild(b);
            });
            chat.insertBefore(div, document.getElementById('anchor'));
            forceScroll();
        }

        function handleLocationChoice(loc) {
            userData.location = loc;
            if(loc === 'Other') {
                addMsg('Which specific college or city are you looking for?', 'in');
                input.disabled = false; btn.disabled = false; btn.classList.remove('opacity-50');
                input.focus();
                currentStep = "ASK_OTHER_UNI";
            } else {
                showTyping(() => {
                    addMsg(`Found some top-rated universities in <b>${loc}</b> for your course:`, 'in');
                    renderList(loc);
                });
            }
        }

        function renderList(loc) {
            const wrapper = document.createElement('div');
            wrapper.className = 'w-[85%] self-start fade-in mb-4';
            wrapper.innerHTML = `
                <div class="wa-list-header rounded-t-2xl border border-b-0 px-5 py-3.5"><i class="fas fa-university mr-2"></i> Universities in ${loc}</div>
                <div class="wa-list-box rounded-t-none mt-0 shadow-lg"></div>
            `;
            const listBox = wrapper.querySelector('.wa-list-box');
            (collegeData[loc] || []).forEach(c => {
                const item = document.createElement('div');
                item.className = 'wa-list-item px-5 py-3.5 border-b last:border-b-0';
                item.innerText = `${c} University`;
                item.onclick = function() { 
                    wrapper.classList.add('hide-anim');
                    setTimeout(() => wrapper.remove(), 300);
                    const selectedCollege = `${c} University`;
                    userData.college = selectedCollege;
                    saveLead();
                    addMsg(selectedCollege, 'out');
                    showTyping(() => {
                        addMsg(`Success! A career guide will contact you regarding <b>${selectedCollege}</b> soon.`, 'in');
                    });
                };
                listBox.appendChild(item);
            });
            chat.insertBefore(wrapper, document.getElementById('anchor'));
            forceScroll();
        }

        // --- DASHBOARD LOGIC ---

        function saveLead() {
            const leads = JSON.parse(localStorage.getItem('automex_leads') || '[]');
            const newLead = {
                ...userData,
                id: Date.now(),
                timestamp: new Date().toLocaleDateString('en-GB', { day: '2-digit', month: 'short', hour: '2-digit', minute: '2-digit' })
            };
            leads.unshift(newLead);
            localStorage.setItem('automex_leads', JSON.stringify(leads));
        }

        function renderLeads() {
            const leads = JSON.parse(localStorage.getItem('automex_leads') || '[]');
            leadsGrid.innerHTML = "";
            
            if(leads.length === 0) {
                emptyState.classList.remove('hidden');
                return;
            }
            
            emptyState.classList.add('hidden');
            leads.forEach(lead => {
                const card = document.createElement('div');
                card.className = 'glass-card p-6 rounded-[2rem] transition-all flex flex-col gap-5';
                card.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div class="w-12 h-12 bg-emerald-500 rounded-2xl flex items-center justify-center shadow-lg shadow-emerald-500/20">
                            <i class="fas fa-user-graduate text-white text-lg"></i>
                        </div>
                        <div class="text-right">
                            <span class="block text-[10px] text-slate-500 font-bold uppercase tracking-widest">Received</span>
                            <span class="text-[11px] text-slate-300 font-medium">${lead.timestamp}</span>
                        </div>
                    </div>
                    <div>
                        <h3 class="text-white font-extrabold text-xl tracking-tight mb-1">${lead.name}</h3>
                        <div class="inline-flex items-center px-2.5 py-0.5 rounded-full text-[11px] font-bold bg-emerald-500/10 text-emerald-400 border border-emerald-500/20">
                            ${lead.course}
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-4 mt-2">
                        <div class="bg-slate-800/40 p-3 rounded-2xl border border-slate-700/50">
                            <span class="block text-[9px] text-slate-500 uppercase font-bold tracking-wider mb-1">Region</span>
                            <div class="flex items-center gap-2">
                                <i class="fas fa-map-pin text-emerald-500 text-[10px]"></i>
                                <span class="text-slate-200 text-xs font-semibold">${lead.location}</span>
                            </div>
                        </div>
                        <div class="bg-slate-800/40 p-3 rounded-2xl border border-slate-700/50">
                            <span class="block text-[9px] text-slate-500 uppercase font-bold tracking-wider mb-1">Institution</span>
                            <div class="flex items-center gap-2">
                                <i class="fas fa-building text-emerald-500 text-[10px]"></i>
                                <span class="text-slate-200 text-xs font-semibold truncate">${lead.college.split(' ')[0]}</span>
                            </div>
                        </div>
                    </div>
                    <div class="pt-4 border-t border-slate-800/60 mt-auto">
                        <div class="flex items-center gap-2 text-slate-400">
                             <i class="fas fa-check-circle text-emerald-500 text-xs"></i>
                             <span class="text-[11px] font-medium italic">Verified Lead: ${lead.college}</span>
                        </div>
                    </div>
                `;
                leadsGrid.appendChild(card);
            });
        }

        function clearLeads() {
            if(confirm('This will wipe all collected leads from this browser. Continue?')) {
                localStorage.removeItem('automex_leads');
                renderLeads();
            }
        }

        input.addEventListener("keypress", (e) => { if(e.key === "Enter" && !input.disabled) handleUserInput(); });

        initChat();
    </script>
</body>
</html>
